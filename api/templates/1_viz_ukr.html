<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en-us">
​

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>Anti-Civilian Violence Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="../../assets/css/style.css">

    <!-- Leaflet JavaScript code -->
    <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js"
        integrity="sha512-tAGcCfR4Sc5ZP5ZoVz0quoZDYX5aCtEm/eu1KhSLj2c9eFrylXZknQYmxUssFaVJKvvc0dJQixhGjG2yXWiV9Q=="
        crossorigin=""></script>


    <!-- Marker cluster JavaScript code -->
    <script type="text/javascript"
        src="https://unpkg.com/leaflet.markercluster@1.0.3/dist/leaflet.markercluster.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css"
        integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
        crossorigin="" />

    <!-- Marker cluster CSS -->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.css">
    <link rel="stylesheet" type="text/css"
        href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.Default.css">
    
        <!-- Plotly -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
​

<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand text-light-green" href="index.html" style="color: rgb(253, 141, 66)">Anti-Civilian Violence</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav  me-auto mb-2 mb-lg-0">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Plots
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                            <li><a class="dropdown-item" href="visualizations/1_viz.html">Ukraine</a></li>
                            <li><a class="dropdown-item" href="visualizations/2_viz.html">Regional Data</a></li>
                            <li><a class="dropdown-item" href="visualizations/3_viz.html">Global Data</a></li>
                        </ul>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active" href="comparison.html">Comparison</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="data.html">Data</a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>

    <section>
        <br>
    </section>


    <!-- SUMARY -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-lg-6">

                    <h1 class="dark:bg-primary dark:text-white">Ukraine</h1>
                    <br>
                    <h5 class="text-light-green">Anti-Civilian Violence Data Analysis</h5>

                    Ukraine is no stranger to conflict. Since ... 
                    Then with the invasion of Ukraine by Russia on (date) Feb 2022, Ukraine was again at the forefront of world news stories.
                    
                    These are the results found in the analysis.
                    </p>
                </div>
                <!-- MAP -->
                <div class="col-md-12">
                    <div class="card" style="width: 80rem; padding-top: 20px; padding-bottom: 20px;">
                        <div class="card-body">
                          <h5 class="card-title">Ukraine: Violence Against Civilians Map Plot</h5>
                          <h6 class="card-subtitle mb-2 text-muted">Conflict locations & information</h6>
                          <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <div id="my_map" style="width: 1200px; height: 600px"></div>
                        </div>
                    </div>
                </div>
            </div>
            <section>
                <br>
            </section>
                <div class="row">
                        <h1 class="dark:bg-primary dark:text-white" style="width: 40rem; padding-top: 20px; padding-bottom: 20px;">Visualisations</h1>
                        <section>
                            <br>
                        </section>
                        <div class="col-6">
                                <div class="card" style="width: 40rem; padding-top: 20px;">
                                    <div class="card-body">
                                        <h5 class="card-title">Ukraine: Fatality Count by Year</h5>
                                        <h6 class="card-subtitle mb-2 text-muted">2018-2022</h6>
                                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                                        <div id="bar" style="width: 600px; height: 400px"></div>
                                    </div>
                                </div>
                        </div>
                        <div class="col-6">
                                <div class="card" style="width: 40rem; padding-top: 20px;">
                                    <div class="card-body">
                                        <h5 class="card-title">Ukraine: Fatality Count by Sub-Event Type</h5>
                                        <h6 class="card-subtitle mb-2 text-muted"> SOMETHING</h6>
                                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                                        <div id="pie" style="width: 600px; height: 400px"></div>
                                    </div>
                                </div>
                        </div>
                        <div class="col-6">
                                <div class="card" style="width: 40rem; padding-top: 20px;">
                                    <div class="card-body">
                                        <h5 class="card-title">Ukraine: Fatality Count 2022</h5>
                                        <h6 class="card-subtitle mb-2 text-muted"> SOMETHING</h6>
                                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                                        <div id="lines" style="width: 600px; height: 400px"></div>
                                    </div>
                                </div>
                        </div>
                        <div class="col-6">
                                <div class="card" style="width: 40rem; padding-top: 20px;">
                                    <div class="card-body">
                                        <h5 class="card-title">Ukraine: Fatality Count 2022</h5>
                                        <h6 class="card-subtitle mb-2 text-muted"> SOMETHING</h6>
                                        <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                                        <canvas id="myChart" width="400" height="400"></canvas>
                                    </div>
                                </div>
                        </div>
                            </div>
                        </div>
                    </div>
                </div>
    </section>

    ​
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>

    <!-- <script> var data = {{ geojson|safe }} </script> -->

    <!-- <script src="/static/js/1_viz_ukr.js"></script> -->
    <script>
        var data = {{ geojson|safe }};
        // create map
        // var layers = {
        //     2018: new L.LayerGroup(),
        //     2019: new L.LayerGroup(),
        //     2020: new L.LayerGroup(),
        //     2021: new L.LayerGroup(),
        //     2022: new L.LayerGroup(),
        // };

        // var overlays = {
        //     "2018": layers.2018,
        //     "2019": layers.2019, 
        //     "2020": layers.2020,
        //     "2021": layers.2021,
        //     "2022": layers.2022
            
        // }
        var myMap = L.map("my_map", {
            center: [49.05, 33.22],
            zoom: 6, 
            // layers: [
            //     layers.2018, 
            //     layers.2019, 
            //     layers.2020,
            //     layers.2021,
            //     layers.2022
            // ]
        });

        // Add tile layer 
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(myMap);

        // L.control.layers(null, overlays).addTo(myMap);

        // // Legend to display information about map
        // var info = L.control({
        //     position: "bottomright"
        // });

        // info.onAdd = function() {
        // var div = L.DomUtil.create("div", "legend");
        // return div;
        // };
        // // Add the info legend to the map.
        // info.addTo(myMap);



        // loop over geojson to find radius size 
    //    var fatalities = []
        
    //     for (i=0; i< featuresData.length; i++){
    //         fatalities.push(parseInt(featuresData[i]['properties']['fatalities']));          
    //     }

        var markers = {
            opacity: 1,
            fillOpacity: 1,
            fillColor: "orange",
            color: "orange",
            //radius: fatalities
            radius: 3,
            stroke: true,
            weight: 0.5
        };


        L.geoJSON(data, {
            pointToLayer: function (feature, latlng) {
                return L.circleMarker(latlng, markers);
            },
            onEachFeature: function (feature, layer) {
                layer.bindPopup("Location: " + feature.properties.location
                    + "<br> Event Date: " + feature.properties.event_date
                    + "<br>Sub-Event Type: " + feature.properties.sub_event_type
                    + "<br>Fatalities: " + feature.properties.fatalities
                    + "<br>Notes: " + feature.properties.notes)
                // layer.on({
                // mouseover: highlightFeature,
                // mouseout: resetHighlight,
                // click: zoomToFeature
                // });
            }
        }).addTo(myMap);


        // Bar Plot 
        // shan add in stacked bar chart here with event_id on top

        var featuresData = data["features"]
        var year = []
        var event_date = []
        var fatalities = []
        var locations = []
        var subEventType = []




        for (i=0; i< featuresData.length; i++){
            year.push(featuresData[i]['properties']['year']);
            fatalities.push(parseInt(featuresData[i]['properties']['fatalities']));
            event_date.push(parseInt(featuresData[i]['properties']['event_date']));      
        }


            var trace1 = {
                x: year,
                y: fatalities,
                name: 'Fatalities',
                type: "bar"
            };

            var trace2 = {
                x: year,
                y: event_date,
                name: 'Events',
                type: "bar"

            };

            varData = [trace1, trace2];
        
            var barLayout = { 
                barmode: 'stack',
                title: "Events & Fatalities over time: 2018-2022" };
            // plot
            Plotly.newPlot("bar", varData, barLayout);


        // Pie Plot 

        for (i=0; i< featuresData.length; i++){
            subEventType.push(featuresData[i]['properties']['sub_event_type']);
            fatalities.push(parseInt(featuresData[i]['properties']['fatalities']));          
        }

        function piePlot() {

        pieData = [
            {
                values: fatalities,
                labels: subEventType,
                type: "pie",
                insidetextorientation: "radial"
            }
        ];

        var pieLayout = { 
            title: "Fatalities by Sub Event Type"};
        // plot
        Plotly.newPlot("pie", pieData, pieLayout);

        };

        piePlot()

        // line chart  

        for (i=0; i< featuresData.length; i++){
            event_date.push(featuresData[i]['properties']['event_date']); 
        }

        // var startDate = '2022-01-06 00:00:00'
        // var endDate = '2022-06-09 00:00:00'

        // var dates22 = []

        // var loopThroughDateRange = (startDate, endDate) => {
        //     let dateOne = new event_date(startDate);
        //     let dateTwo = new event_date(endDate);
        //         for(var i = dateOne; i<= dateTwo; i.setDate(i.getDate()+1)){
        //             dates22.push([dates22]);
        // }
        // }

            function plotLines() {

                lineData = [
                    {
                        x: dates22,
                        y: fatalities,
                        //text: ,
                        type: "lines"
                    }
                ];

                var linesLayout = { title: "Conflict Fatalities in 2022" };
                // plot
                Plotly.newPlot("lines", lineData, lineLayout);

                };

                plotLines()
        
  
            const ctx = document.getElementById('myChart').getContext('2d');
            const myChart = new Chart(ctx, {

                // use orange 
                type: 'bar',
                data: {
                    labels: ['2018', '2019', '2020', '2021', '2022'],
                    datasets: [{
                        label: '# of Votes',
                        data: [{
                            x: year,
                            y: fatalities
                    }],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
            });
</script>

</body>

</html>